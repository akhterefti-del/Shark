<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />
  <title>Shark Bounty | Earn SHB</title>
  <link rel="icon" href="https://github.com/s42144/Shark-Bounty/blob/dc7c6b7451be7e4767f4c84bdecf7dfed3082bed/HOME.png?raw=true" />
  <!-- Monetag SDK -->
  <script src="//libtl.com/sdk.js" data-zone="9970324" data-sdk="show_9970324"></script>
  <!-- Firebase App (the core Firebase SDK) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-analytics-compat.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root {
      --bg-gradient: linear-gradient(135deg, #0a0e1a 0%, #1a2332 100%);
      --bg-gradient2: linear-gradient(120deg, #1a2332 0%, #2d3748 100%);
      --card-bg: rgba(255,255,255,0.08);
      --panel-bg: rgba(26, 35, 50, 0.6);
      --accent: #00d4ff;
      --accent2: #ff6b35;
      --btn-gradient: linear-gradient(95deg, #00d4ff 0%, #ff6b35 100%);
      --btn-shadow: 0 6px 24px rgba(0, 212, 255, 0.3);
      --btn-radius: 22px;
      --btn-txt: #fff;
      --card-radius: 26px;
      --shadow: 0 4px 32px rgba(0, 0, 0, 0.3);
      --input-bg: rgba(255,255,255,0.12);
      --input-border: #00d4ff;
      --card-line: rgba(255,255,255,0.1);
      --nav-bg: rgba(15, 23, 42, 0.98);
      --nav-active: #ff6b35;
      --tapplus-glow: 0 0 18px rgba(0, 212, 255, 0.6), 0 2px 14px rgba(255, 107, 53, 0.7);
      --profile-glow: 0 0 36px rgba(0, 212, 255, 0.4), 0 0 16px rgba(255, 107, 53, 0.5);
    }
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      width: 100vw;
      font-family: 'Inter', 'Segoe UI', Arial, sans-serif;
      background: var(--bg-gradient);
      color: #fff;
      overflow-x: hidden;
      touch-action: manipulation;
      min-height: 100vh;
    }
    #intro-video {
      position: fixed;
      top: 0; left: 0; width: 100vw; height: 100vh;
      object-fit: cover;
      z-index: 9999;
      background: #000;
      display: block;
    }
    #app {
      display: none;
      width: 100vw;
      min-height: 100vh;
      padding-bottom: 76px;
      box-sizing: border-box;
      background: var(--bg-gradient2);
      background-attachment: fixed;
      background-repeat: no-repeat;
      background-size: cover;
    }
    .home-main {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      width: 100vw;
      min-height: 100vh;
      height: 100vh;
      overflow: hidden;
      position: relative;
      background: none;
      touch-action: none;
      overscroll-behavior: none;
    }
    #main-content { width: 100vw; }
    .home-balance {
      font-size: 4.5rem;
      font-weight: 900;
      letter-spacing: 2px;
      margin-bottom: 0;
      margin-top: 32px;
      color: #fff;
      text-align: center;
      user-select: none;
      background: rgba(15, 23, 42, 0.4);
      border-radius: 22px;
      padding: 15px 50px;
      box-shadow: 0 8px 40px rgba(0, 212, 255, 0.3);
      border: 2px solid var(--accent2);
      transition: color .2s, background .3s;
      text-shadow: 0 2px 24px rgba(0, 0, 0, 0.5);
      position: relative;
      z-index: 10;
      width: auto;
      margin-left: auto;
      margin-right: auto;
      backdrop-filter: blur(10px);
    }
    .coin-btn-3d-wrap {
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
      max-width: 400px;
      height: 400px;
      margin: 20px auto 20px auto;
      z-index: 3;
      touch-action: manipulation;
      background: none;
      pointer-events: none;
    }
    .coin-3d-anim {
      position: absolute;
      left: 50%;
      top: 50%;
      width: 280px;
      height: 280px;
      transform: translate(-50%, -50%);
      z-index: 2;
      pointer-events: auto;
      background: none;
      touch-action: manipulation;
      cursor: pointer;
      border-radius: 50%;
      transition: transform .17s;
      border: none;
      outline: none;
      -webkit-tap-highlight-color: rgba(0,0,0,0);
      user-select: none;
      object-fit: contain;
      filter: drop-shadow(0 0 20px rgba(0, 212, 255, 0.5));
    }
    .coin-3d-anim:active {
      transform: translate(-50%, -50%) scale(0.95);
    }
    .coin-glow-effect {
      position: absolute;
      left: 50%;
      top: 50%;
      width: 320px;
      height: 320px;
      transform: translate(-50%, -50%);
      border-radius: 50%;
      background: radial-gradient(circle, rgba(0, 212, 255, 0.4) 0%, rgba(255, 107, 53, 0.3) 50%, transparent 70%);
      animation: glowPulse 2s ease-in-out infinite;
      pointer-events: none;
      z-index: 1;
    }
    @keyframes glowPulse {
      0%, 100% { opacity: 0.6; transform: translate(-50%, -50%) scale(1); }
      50% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
    }
    .sparkle-container {
      position: absolute;
      left: 50%;
      top: 50%;
      width: 350px;
      height: 350px;
      transform: translate(-50%, -50%);
      pointer-events: none;
      z-index: 0;
    }
    .sparkle {
      position: absolute;
      width: 8px;
      height: 8px;
      background: #fff;
      border-radius: 50%;
      opacity: 0;
      animation: sparkleAnim 3s ease-in-out infinite;
      box-shadow: 0 0 10px #00d4ff, 0 0 20px #ff6b35;
    }
    @keyframes sparkleAnim {
      0%, 100% { opacity: 0; transform: scale(0); }
      50% { opacity: 0.8; transform: scale(1); }
    }
    .sparkle:nth-child(1) { top: 10%; left: 50%; animation-delay: 0s; }
    .sparkle:nth-child(2) { top: 25%; left: 85%; animation-delay: 0.5s; }
    .sparkle:nth-child(3) { top: 50%; left: 95%; animation-delay: 1s; }
    .sparkle:nth-child(4) { top: 75%; left: 85%; animation-delay: 1.5s; }
    .sparkle:nth-child(5) { top: 90%; left: 50%; animation-delay: 2s; }
    .sparkle:nth-child(6) { top: 75%; left: 15%; animation-delay: 2.5s; }
    .sparkle:nth-child(7) { top: 50%; left: 5%; animation-delay: 0.3s; }
    .sparkle:nth-child(8) { top: 25%; left: 15%; animation-delay: 0.8s; }
    .tap-plus {
      position: absolute;
      left: 50%; top: 30%;
      transform: translate(-50%, -50%);
      color: #fff;
      font-size: 3.7rem;
      font-weight: bold;
      opacity: 0;
      transition: opacity 0.18s, transform 0.28s;
      pointer-events: none;
      z-index: 5;
      text-shadow: var(--tapplus-glow), 0 2px 16px #0009;
      font-family: inherit;
      letter-spacing: 2.5px;
      filter: drop-shadow(0px 8px 16px rgba(255, 107, 53, 0.7));
      user-select: none;
    }
    .home-info-row {
      width: 100vw;
      max-width: 900px;
      margin: 0 auto 0;
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 32px;
      background: rgba(15, 23, 42, 0.4);
      box-shadow: 0 4px 24px rgba(0, 212, 255, 0.2);
      border-radius: 26px;
      border: 2px solid var(--card-line);
      z-index: 12;
      position: relative;
      padding: 28px 48px;
      margin-bottom: 0;
      margin-top: 30px;
      backdrop-filter: blur(10px);
    }
    .home-info-col {
      flex: 1;
      text-align: center;
      color: #fff;
      font-size: 1.33rem;
      font-weight: 400;
      line-height: 1.38;
      letter-spacing: 0.01em;
      background: none;
      border: none;
      box-shadow: none;
      padding: 0;
    }
    .home-info-col .label {
      font-size: 1.22rem;
      font-weight: 400;
      color: #a0d7ff;
      margin-bottom: 11px;
      display: block;
      letter-spacing: 0.07em;
      text-shadow: 0 2px 12px rgba(0, 212, 255, 0.3);
    }
    .home-info-col .value {
      font-size: 1.43rem;
      font-weight: 800;
      margin-bottom: 3px;
      display: block;
      color: #fff;
      text-shadow: 0 2px 8px rgba(0, 212, 255, 0.4);
    }
    .home-info-col .desc {
      font-size: 1.16rem;
      color: #ffd8c9;
      margin-top: 2px;
      display: block;
    }
    .nav-bar {
      position: fixed;
      bottom: 0; left: 0; width: 100vw;
      background: var(--nav-bg);
      display: flex;
      gap: 0;
      justify-content: space-around;
      align-items: center;
      padding: 12px 0 7px 0;
      z-index: 20;
      box-shadow: 0 -2px 32px 0px rgba(0, 0, 0, 0.3);
      border-top: 2px solid var(--accent2);
      backdrop-filter: blur(14px);
    }
    .nav-btn {
      flex: 1;
      background: none;
      border: none;
      outline: none;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 0;
      min-width: 75px;
      font-size: 1.15rem;
      color: #fff;
      cursor: pointer;
      border-radius: 19px 19px 0 0;
      opacity: 0.92;
      transition: background 0.19s, opacity 0.14s, color 0.22s;
      box-shadow: none;
      font-weight: 600;
    }
    .nav-btn img {
      width: 44px; height: 44px;
      margin-bottom: 3px;
      border-radius: 10px;
      border: 2px solid transparent;
      box-shadow: 0 2px 14px rgba(0, 212, 255, 0.2);
      transition: border .13s, box-shadow .13s;
    }
    .nav-btn.active {
      background: var(--btn-gradient);
      opacity: 1;
      color: #fff;
      box-shadow: 0 -2px 32px rgba(0, 212, 255, 0.4);
    }
    .nav-btn.active img {
      border: 2px solid var(--nav-active);
      box-shadow: 0 4px 18px rgba(255, 107, 53, 0.4), 0 0 0 8px rgba(255, 255, 255, 0);
    }
    .booster-main, .earn-main, .profile-main, .ranking-main {
      margin: 48px auto 0;
      max-width: 480px;
      width: 99vw;
      padding: 34px 0 0 0;
      background: var(--card-bg);
      border-radius: var(--card-radius);
      box-shadow: var(--shadow), 0 6px 26px rgba(0, 212, 255, 0.3);
      border: 2px solid var(--card-line);
    }
    .booster-section {
      margin: 32px auto 30px auto;
      padding: 34px 22px 22px 22px;
      border-radius: 26px;
      background: var(--panel-bg);
      box-shadow: 0 4px 24px rgba(0, 212, 255, 0.2);
      border-left: 6px solid var(--accent);
      border-right: 6px solid var(--accent2);
      background-blend-mode: overlay;
      background-size: cover;
      background-position: center;
      backdrop-filter: blur(5px);
    }
    .booster-section .title {
      font-size: 1.32rem;
      font-weight: bold;
      margin-bottom: 13px;
      color: var(--accent);
      letter-spacing: 0.07em;
    }
    .booster-section .price {
      font-size: 1.19rem;
      font-weight: 500;
      color: var(--accent2);
      margin-bottom: 16px;
    }
    .booster-section .desc {
      font-size: 1.13rem;
      color: #e4f5ff;
      margin-top: 12px;
      opacity: 0.97;
    }
    .buy-btn {
      width: 100%;
      padding: 16px 0;
      margin: 14px 0;
      background: var(--btn-gradient);
      color: var(--btn-txt);
      border: none;
      border-radius: var(--btn-radius);
      font-size: 1.19rem;
      font-weight: 700;
      cursor: pointer;
      box-shadow: var(--btn-shadow);
      transition: background 0.13s, box-shadow .12s, filter .11s;
      letter-spacing: 0.09em;
      outline: none;
    }
    .buy-btn:disabled {
      background: #444;
      color: #bbb;
      box-shadow: none;
      cursor: not-allowed;
    }
    .buy-btn:not(:disabled):hover {
      filter: brightness(1.13) contrast(1.13);
      box-shadow: 0 8px 38px rgba(255, 107, 53, 0.6);
    }
    .earn-main { padding-bottom: 35px; }
    .earn-graph-bar {
      margin-top: 20px;
      margin-bottom: 32px;
      background: var(--panel-bg);
      border-radius: 16px;
      padding: 18px;
      border: 2px solid var(--accent2);
      box-shadow: 0 2px 14px rgba(0, 212, 255, 0.2);
    }
    .earn-stats-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: var(--panel-bg);
      border-radius: 18px;
      padding: 16px 19px;
      margin-bottom: 28px;
      border: 2px solid var(--accent2);
      box-shadow: 0 1px 14px rgba(0, 212, 255, 0.2);
    }
    .earn-stat-cell { text-align: center; flex: 1; }
    .earn-stat-label {
      font-size: 1.07rem;
      color: #a0d7ff;
      font-weight: 600;
      margin-bottom: 2px;
      display: block;
    }
    .earn-stat-value {
      font-size: 1.23rem;
      color: var(--accent2);
      font-weight: bold;
      display: block;
    }
    .ad-section {
      margin-bottom: 23px;
      padding: 16px 16px 22px 16px;
      background: var(--panel-bg);
      border-radius: 20px;
      box-shadow: 0 1px 14px rgba(0, 212, 255, 0.2);
      text-align: center;
      border: 2px solid var(--accent2);
    }
    .show-ad-btn {
      width: 98%;
      padding: 15px 0;
      margin: 15px 0 0 0;
      background: var(--btn-gradient);
      color: var(--btn-txt);
      border: none;
      border-radius: var(--btn-radius);
      font-size: 1.12rem;
      font-weight: 700;
      cursor: pointer;
      box-shadow: var(--btn-shadow);
      transition: background 0.13s, filter .13s;
      outline: none;
    }
    .show-ad-btn:disabled {
      background: #444;
      color: #bbb;
      box-shadow: none;
      cursor: not-allowed;
    }
    .show-ad-btn:not(:disabled):hover {
      filter: brightness(1.13) contrast(1.13);
    }
    .ad-stats {
      display: flex;
      justify-content: space-between;
      margin: 8px 0 0 0;
      gap: 7px;
    }
    .ad-stats-box {
      background: var(--card-bg);
      border-radius: 12px;
      padding: 7px 14px;
      font-size: 1.09rem;
      font-weight: 600;
      color: var(--accent);
      border: 1.3px solid var(--accent2);
    }
    .task-card {
      display: flex;
      align-items: center;
      background: var(--panel-bg);
      border-radius: 18px;
      margin-bottom: 24px;
      box-shadow: 0 2px 10px rgba(0, 212, 255, 0.2);
      padding: 14px;
      border: 2px solid var(--accent);
      gap: 18px;
    }
    .task-photo {
      width: 62px; height: 62px;
      border-radius: 18px;
      object-fit: cover;
      margin-right: 14px;
      border: 2.5px solid var(--accent2);
    }
    .task-info { flex: 1; }
    .task-title {
      font-size: 1.19rem;
      color: var(--accent);
      font-weight: bold;
      margin-bottom: 5px;
    }
    .task-amount {
      font-size: 1.09rem;
      color: var(--accent2);
      margin-bottom: 5px;
      font-weight: 600;
    }
    .task-btn {
      min-width: 88px;
      padding: 10px 18px;
      border-radius: 16px;
      background: var(--btn-gradient);
      color: var(--btn-txt);
      border: none;
      font-weight: 700;
      font-size: 1.12rem;
      cursor: pointer;
      transition: filter .13s, background .13s;
      box-shadow: 0 2px 11px rgba(255, 107, 53, 0.4);
    }
    .task-btn.completed {
      background: #34343b;
      color: #bbb;
      cursor: not-allowed;
      box-shadow: none;
    }
    .task-btn:not(.completed):hover { filter: brightness(1.17); }
    .profile-main {
      text-align: center;
      padding-bottom: 40px;
      position: relative;
      background: linear-gradient(120deg, #1a2332 70%, #2d3748 120%);
      border-radius: 32px;
      margin: 54px auto 0 auto;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
      border: 2px solid rgba(0, 212, 255, 0.3);
      max-width: 510px;
      width: 97vw;
    }
    .avatar-glow {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 18px;
      margin-top: 20px;
    }
    .avatar-img-pro {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      border: 6px solid var(--accent2);
      object-fit: cover;
      background: #fff;
      box-shadow: 0 0 32px rgba(255, 107, 53, 0.7), 0 0 0 10px rgba(0, 212, 255, 0.3);
      margin: 0 auto 0 auto;
      filter: drop-shadow(0 0 16px rgba(255, 255, 255, 0.5));
      display: block;
    }
    .userid-pro {
      display: inline-block;
      background: linear-gradient(90deg,rgba(0, 212, 255, 0.2),rgba(255, 107, 53, 0.2));
      border-radius: 14px;
      padding: 8px 22px;
      color: var(--accent);
      font-weight: 800;
      font-size: 1.19rem;
      letter-spacing: 0.06em;
      border: 2px solid var(--accent2);
      margin-left: 6px;
      margin-right: 6px;
      margin-bottom: 3px;
      box-shadow: 0 2px 8px rgba(0, 212, 255, 0.2);
    }
    .copy-btn-pro {
      background: var(--btn-gradient);
      border: none;
      border-radius: 50%;
      padding: 7px 7px;
      cursor: pointer;
      margin-left: 7px;
      transition: filter .13s;
      width: 34px; height: 34px;
      display: inline-flex; align-items: center; justify-content: center;
      box-shadow: var(--btn-shadow);
      margin-bottom: 3px;
    }
    .copy-btn-pro img { width: 20px; height: 20px; border-radius: 50%; }
    .profile-divider {
      width: 90%;
      height: 2px;
      background: linear-gradient(90deg,rgba(0, 212, 255, 0.4),rgba(255, 107, 53, 0.4));
      border: none;
      margin: 18px auto 14px auto;
      border-radius: 3px;
      opacity: 0.7;
    }
    .profile-wallet-box {
      background: rgba(15, 23, 42, 0.3);
      padding: 17px 10px;
      border-radius: 13px;
      margin: 0 auto 16px auto;
      max-width: 350px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      box-shadow: 0 2px 8px rgba(0, 212, 255, 0.2);
      border: 1.5px solid var(--accent2);
    }
    .wallet-label {
      font-weight: bold;
      color: var(--accent2);
      margin-right: 4px;
      font-size: 1.09rem;
    }
    .ton-form-pro {
      display: flex;
      align-items: center;
      gap: 9px;
    }
    .ton-input-pro {
      padding: 10px 16px;
      border-radius: 13px;
      border: 2px solid var(--input-border);
      background: var(--input-bg);
      color: #fff;
      font-size: 1.05rem;
      outline: none;
      width: 170px;
      margin-right: 0;
    }
    .ton-save-btn-pro {
      background: var(--btn-gradient);
      color: #fff;
      border: none;
      border-radius: 14px;
      padding: 8px 18px;
      font-weight: 700;
      font-size: 1.06rem;
      cursor: pointer;
      box-shadow: var(--btn-shadow);
      transition: filter .13s;
    }
    .ton-save-btn-pro:hover { filter: brightness(1.11); }
    .referral-section {
      margin-top: 22px;
      background: var(--panel-bg);
      border-radius: 18px;
      padding: 16px 14px 13px 14px;
      box-shadow: 0 2px 10px rgba(0, 212, 255, 0.2);
      border: 2px solid var(--accent2);
      max-width: 390px;
      margin-left: auto;
      margin-right: auto;
    }
    .ref-link-box {
      display: flex;
      align-items: center;
      gap: 9px;
      margin-bottom: 10px;
      justify-content: center;
    }
    .ref-link {
      font-size: 1.08rem;
      color: var(--accent);
      font-weight: 700;
      background: var(--card-bg);
      padding: 5px 18px;
      border-radius: 13px;
      letter-spacing: 0.08em;
      user-select: all;
      cursor: pointer;
      border: 1.5px solid var(--accent2);
    }
    .ref-copy-btn-pro {
      background: var(--btn-gradient);
      border: none;
      border-radius: 50%;
      padding: 7px 7px;
      cursor: pointer;
      transition: filter .13s;
      width: 34px; height: 34px;
      display: inline-flex; align-items: center; justify-content: center;
      box-shadow: var(--btn-shadow);
    }
    .ref-copy-btn-pro img { width: 20px; height: 20px; border-radius: 50%; }
    .ref-counts {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
      margin-top: 5px;
      font-size: 1.09rem;
      color: #fff;
    }
    .ref-counts b {
      color: var(--accent2);
    }
    .redeem-profile-box {
      margin: 26px auto 0 auto;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 11px;
      max-width: 330px;
    }
    .redeem-input {
      padding: 13px 21px;
      border-radius: 15px;
      border: 2.5px solid var(--input-border);
      background: var(--input-bg);
      color: #fff;
      font-size: 1.19rem;
      outline: none;
      width: 124px;
      letter-spacing: 7px;
      font-weight: 800;
      text-align: center;
    }
    .redeem-btn {
      background: var(--btn-gradient);
      color: #fff;
      border: none;
      border-radius: 16px;
      padding: 13px 32px;
      font-weight: 800;
      font-size: 1.19rem;
      cursor: pointer;
      box-shadow: var(--btn-shadow);
      transition: filter .13s;
    }
    .redeem-btn:hover { filter: brightness(1.13); }
    .profile-section-card {
      margin: 22px auto;
      background: var(--panel-bg);
      border-radius: 18px;
      padding: 20px 14px;
      box-shadow: 0 2px 10px rgba(0, 212, 255, 0.2);
      border: 2px solid var(--accent2);
      max-width: 390px;
      margin-left: auto;
      margin-right: auto;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .profile-section-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 4px 20px rgba(0, 212, 255, 0.4);
    }
    .profile-section-img {
      width: 100%;
      max-width: 350px;
      height: auto;
      border-radius: 12px;
      margin-bottom: 12px;
      border: 2px solid var(--accent);
    }
    .profile-section-title {
      font-size: 1.25rem;
      font-weight: bold;
      color: var(--accent);
      margin-bottom: 8px;
      text-align: center;
    }
    .ranking-main {
      padding-bottom: 38px;
    }
    .ranking-position {
      font-size: 1.17rem;
      margin-bottom: 12px;
      color: var(--accent2);
      text-align: center;
      font-weight: bold;
    }
    .ranking-list { margin-top: 13px; }
    .ranking-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: var(--panel-bg);
      border-radius: 16px;
      padding: 14px 22px;
      margin-bottom: 11px;
      font-size: 1.12rem;
      color: #fff;
      border: 2px solid var(--accent);
      box-shadow: 0 2px 16px rgba(0, 212, 255, 0.2);
    }
    .ranking-pos {
      font-weight: 800;
      color: var(--accent2);
      font-size: 1.23rem;
      width: 40px;
      text-align: center;
    }
    .ranking-userid {
      flex: 1;
      text-align: left;
      margin-left: 21px;
      color: var(--accent);
      font-weight: 600;
    }
    .ranking-shb {
      font-weight: 800;
      color: var(--accent);
      font-size: 1.17rem;
    }
    .notif {
      position: fixed; top: 5%; left: 50%; transform: translateX(-50%);
      background: var(--btn-gradient);
      color: #fff;
      border-radius: 19px;
      padding: 17px 50px;
      font-size: 1.17rem;
      font-weight: bold;
      z-index: 99999; 
      text-align: center; 
      box-shadow: 0 2px 36px rgba(255, 107, 53, 0.6);
      animation: notifIn 0.24s;
      border: 2.5px solid var(--accent2);
      letter-spacing: 0.06em;
    }
    @keyframes notifIn {0%{opacity:0;transform:scale(0.7) translateX(-50%);}100%{opacity:1;transform:scale(1) translateX(-50%);}}
    @media(max-width:1200px){
      .home-main{margin-top:0;}
      .coin-btn-3d-wrap{max-width:350px;height:350px;}
      .coin-3d-anim{width:250px;height:250px;}
      .coin-glow-effect{width:280px;height:280px;}
      .sparkle-container{width:300px;height:300px;}
      .home-balance{font-size:3.2rem;}
      .home-info-row{max-width:97vw;}
      .booster-main,.earn-main,.profile-main,.ranking-main{margin-top:31px;}
      .booster-main, .earn-main, .profile-main, .ranking-main {padding: 17px 0;}
      .booster-section{padding:19px 8px;}
      .notif{font-size:1.03rem;padding:12px 17px;}
      .redeem-btn{padding:10px 19px;}
      .avatar-img-pro{width:90px;height:90px;}
      .ref-link{font-size:1.02rem;}
      .ranking-list{margin-top: 8px;}
    }
    @media(max-width:600px){
      .coin-btn-3d-wrap{max-width:300px;height:300px;}
      .coin-3d-anim{width:220px;height:220px;}
      .coin-glow-effect{width:250px;height:250px;}
      .sparkle-container{width:270px;height:270px;}
      .home-balance{font-size:2.5rem;padding:10px 30px;}
      .home-info-row{padding: 15px 20px;max-width:96vw;}
      .booster-main, .earn-main, .profile-main, .ranking-main {padding: 15px 0;}
      .booster-section{padding:15px 12px;}
      .notif{font-size:0.98rem;padding:10px 15px;}
      .redeem-btn{padding:8px 20px;}
      .avatar-img-pro{width:80px;height:80px;}
      .ref-link{font-size:0.9rem;}
      .ranking-list{margin-top: 6px;}
      .tap-plus{font-size:2.5rem;}
    }
  </style>
<script src="https://sites.super.myninja.ai/_assets/ninja-daytona-script.js"></script>
</head>
<body>
  <!-- Intro Video -->
  <video id="intro-video" autoplay playsinline muted>
    <source src="https://github.com/s42144/Shark-Bounty/raw/8b67f2028cd3d33d6545243ea43a57958c428edf/29f4182c-fb84-4f6e-830f-f560ae571afe.mp4" type="video/mp4" />
    Your browser does not support the video tag.
  </video>
  <!-- Main App -->
  <div id="app">
    <div id="main-content"></div>
    <div class="nav-bar" id="navBar">
      <button class="nav-btn active" data-tab="home">
        <img src="https://github.com/akhterefti-del/Shark/blob/e7c848276e3281e80d912cab430f8f62e9cf679e/homebtn%20(1).png?raw=true" alt="Home" />
      </button>
      <button class="nav-btn" data-tab="booster">
        <img src="https://github.com/akhterefti-del/Shark/blob/823776a5bcbad3401fd886a8f932726c1bd88e9a/boostbt%20(1).png?raw=true" alt="Booster" />
      </button>
      <button class="nav-btn" data-tab="earn">
        <img src="https://github.com/akhterefti-del/Shark/blob/e7c848276e3281e80d912cab430f8f62e9cf679e/earnbtn%20(1).png?raw=true" alt="Earn" />
      </button>
      <button class="nav-btn" data-tab="tasks" style="display:none"></button>
      <button class="nav-btn" data-tab="profile">
        <img src="https://github.com/akhterefti-del/Shark/blob/b5e62135807688bb67f0d564bcbe383d9c0b5eef/profilebtn%20(1).png?raw=true" alt="Profile" />
      </button>
      <button class="nav-btn" data-tab="ranking">
        <img src="https://github.com/akhterefti-del/Shark/blob/e7c848276e3281e80d912cab430f8f62e9cf679e/rankingbtn%20(1).png?raw=true" alt="Ranking" />
      </button>
    </div>
  </div>
  <script>
    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyAHofuS76xf2oGPaJqEtopmcxdoJzjkDL4",
      authDomain: "zmex-investments.firebaseapp.com",
      databaseURL: "https://zmex-investments-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "zmex-investments",
      storageBucket: "zmex-investments.appspot.com",
      messagingSenderId: "971623941364",
      appId: "1:971623941364:web:6c65604fc45c3f64e74aa1",
      measurementId: "G-KQ1LYP77JF"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let userId = null;
    let userData = null;
    let energyTimer = null;
    let adStats = { today: 0, daily: 0, monthly: 0, lifetime: 0 };
    let booster = { energy: 1200, maxEnergy: 1200, multiTap: 1, incomeBooster: false, multiTapCount: 0, maxEnergyUpCount: 0 };
    let coinsEarned = 0;
    let lastEnergyUpdate = Date.now();
    let lastIncomeUpdate = Date.now();
    let rankingData = [];
    let tasksList = [];
    let referrals = { count: 0, eject: 0 };
    let redeemCodes = {};
    let adLoading = false;
    let profileSections = [];

    // Helper: Get timestamp (seconds)
    function now() { return Math.floor(Date.now()/1000); }

    function notify(msg, duration=2100){ 
      const box = document.createElement('div');
      box.className = 'notif'; box.textContent = msg;
      document.body.appendChild(box);
      setTimeout(()=>{ box.remove(); }, duration);
    }

    // Generate/Load User ID
    function getOrSetUserId(){
      let id = localStorage.getItem('shb_userid');
      if(!id){
        id = (Math.floor(10000+Math.random()*89999)).toString();
        localStorage.setItem('shb_userid', id);
      }
      userId = id;
    }
    getOrSetUserId();

    // Save last seen time for offline income/energy calculation
    function saveLastSeenData() {
      if (userData) {
        db.ref('users/'+userId).update({
          lastSeen: now(),
          lastBalance: coinsEarned,
          lastEnergy: booster.energy
        });
      }
    }
    window.onbeforeunload = saveLastSeenData;
    window.onunload = saveLastSeenData;

    // Find time since last seen in seconds, fallback to 0 if not found
    function getOfflineTime(snap) {
      let lastSeen = snap.val() && snap.val().lastSeen;
      if (!lastSeen) return 0;
      let t = now() - lastSeen;
      return t > 0 ? t : 0;
    }

    // Fetch/Create User Data, handle offline energy/income
    function loadUserData(){
      db.ref('users/'+userId).once('value').then(snap=>{
        let offlineTime = getOfflineTime(snap);
        if(snap.exists()) userData = snap.val();
        else {
          userData = {
            balance: 0, energy: 1200, maxEnergy: 1200, multiTap: 1, incomeBooster: false, multiTapCount: 0, maxEnergyUpCount: 0,
            ton: "",
            avatar: "https://github.com/akhterefti-del/Shark/blob/43434e64fd7f0a55152c5e982b6a95f2c0496c5b/Gemini_Generated_Image_ad2lr0ad2lr0ad2l.png?raw=true",
            referrals: 0, eject: 0, completedTasks: {}, adStats:{today:0,daily:0,monthly:0,lifetime:0},
            lastSeen: now(),
            lastBalance: 0,
            lastEnergy: 1200
          };
          db.ref('users/'+userId).set(userData);
        }
        // Handle offline energy recovery
        let energy = userData.energy || 1200;
        let maxEnergy = userData.maxEnergy || 1200;
        let incomeBooster = userData.incomeBooster || false;
        let offlineEnergy = Math.min(energy + offlineTime * 0.5, maxEnergy);
        // Handle offline income booster
        let balance = userData.balance || 0;
        let offlineIncome = 0;
        if (incomeBooster) {
          offlineIncome = Math.floor(offlineTime / 10);
          balance = balance + offlineIncome;
        }
        // Save updated values
        userData.energy = Math.round(offlineEnergy);
        userData.balance = balance;
        coinsEarned = balance;
        booster.energy = userData.energy;
        booster.maxEnergy = userData.maxEnergy;
        booster.multiTap = userData.multiTap;
        booster.incomeBooster = incomeBooster;
        booster.multiTapCount = userData.multiTapCount || 0;
        booster.maxEnergyUpCount = userData.maxEnergyUpCount || 0;
        adStats = userData.adStats||{today:0,daily:0,monthly:0,lifetime:0};
        referrals.count = userData.referrals||0;
        referrals.eject = userData.eject||0;
        db.ref('users/'+userId).update({
          energy: userData.energy,
          balance: balance,
          lastSeen: now(),
          lastBalance: balance,
          lastEnergy: userData.energy
        });
        showTab('home');
        setupIncomeBooster();
      });
    }

    function updateUserData(newData){
      Object.assign(userData, newData);
      db.ref('users/'+userId).update(newData);
      if(newData.balance!==undefined) coinsEarned = newData.balance;
      if(newData.energy!==undefined) booster.energy = newData.energy;
      if(newData.maxEnergy!==undefined) booster.maxEnergy = newData.maxEnergy;
      if(newData.multiTap!==undefined) booster.multiTap = newData.multiTap;
      if(newData.incomeBooster!==undefined) booster.incomeBooster = newData.incomeBooster;
      if(newData.multiTapCount!==undefined) booster.multiTapCount = newData.multiTapCount;
      if(newData.maxEnergyUpCount!==undefined) booster.maxEnergyUpCount = newData.maxEnergyUpCount;
      if(newData.adStats!==undefined) adStats = newData.adStats;
      if(newData.referrals!==undefined) referrals.count = newData.referrals;
      if(newData.eject!==undefined) referrals.eject = newData.eject;
    }

    function showTab(tab){
      document.querySelectorAll('.nav-btn').forEach(btn=>{
        btn.classList.toggle('active',btn.dataset.tab===tab);
      });
      if(tab==='home') renderHome();
      if(tab==='booster') renderBooster();
      if(tab==='earn') renderEarn();
      if(tab==='profile') renderProfile();
      if(tab==='ranking') renderRanking();
    }

    // Home Section with tap logic
    function renderHome(){
      let profit = booster.incomeBooster ? Math.floor(coinsEarned/3600) : 0;
      let maxTouch = booster.multiTap;
      let html = `<div class="home-main" id="homeMain">
        <div class="home-balance" id="homeBalance">${coinsEarned}</div>
        <div class="coin-btn-3d-wrap" id="coinWrap">
          <div class="sparkle-container">
            <div class="sparkle"></div>
            <div class="sparkle"></div>
            <div class="sparkle"></div>
            <div class="sparkle"></div>
            <div class="sparkle"></div>
            <div class="sparkle"></div>
            <div class="sparkle"></div>
            <div class="sparkle"></div>
          </div>
          <div class="coin-glow-effect"></div>
          <img src="https://github.com/akhterefti-del/Shark/blob/eec9a5de183800435c0f781a44b5da5722479f20/sharkcoin.png?raw=true" class="coin-3d-anim" id="coin3d" alt="Shark Coin" />
          <span class="tap-plus" id="tapPlus">+1</span>
        </div>
        <div class="home-info-row">
          <div class="home-info-col">
            <span class="label">ENERGY</span>
            <span class="value" id="energyLabel">${Math.floor(booster.energy)} / ${booster.maxEnergy}</span>
            <span class="desc">+0.5/sec, -1/tap</span>
          </div>
          <div class="home-info-col">
            <span class="label">FINGER</span>
            <span class="value" id="fingerLabel">${maxTouch}</span>
            <span class="desc">multi-finger tap</span>
          </div>
          <div class="home-info-col">
            <span class="label">PROFIT</span>
            <span class="value" id="profitLabel">${profit}</span>
            <span class="desc">every hour</span>
          </div>
        </div>
      </div>`;
      document.getElementById('main-content').innerHTML = html;
      setupCoinTapping();
      setupEnergyRecovery();
      document.body.style.overflow = "hidden";
      document.documentElement.style.overflow = "hidden";
      document.getElementById('main-content').style.overflow = "hidden";
      document.getElementById('main-content').style.height = "100vh";
    }

    // Coin tapping logic with PNG image
    function setupCoinTapping() {
      const coin = document.getElementById('coin3d');
      if (!coin) return;

      function tapCoin(tapCount) {
        if (booster.energy < tapCount) {
          notify('Not enough energy!');
          let tapPlus = document.getElementById('tapPlus');
          tapPlus.textContent = '!';
          tapPlus.style.color = '#ff5b5b';
          tapPlus.style.opacity = 1;
          tapPlus.style.transform = 'translate(-50%, -50%) scale(1.17)';
          setTimeout(()=>{tapPlus.style.opacity=0;tapPlus.style.transform='translate(-50%, -50%) scale(1)';tapPlus.style.color='#fff';},550);
          return;
        }
        booster.energy -= tapCount;
        coinsEarned += tapCount;
        updateUserData({balance:coinsEarned,energy:booster.energy});
        let tapPlus = document.getElementById('tapPlus');
        tapPlus.textContent = '+' + tapCount;
        tapPlus.style.opacity = 1;
        tapPlus.style.transform = 'translate(-50%, -50%) scale(1.24)';
        setTimeout(()=>{tapPlus.style.opacity=0;tapPlus.style.transform='translate(-50%, -50%) scale(1)';},420);
        updateEnergyBar();
        document.getElementById('homeBalance').textContent = coinsEarned;
      }

      coin.onmousedown = function(e){e.preventDefault();};
      coin.onselectstart = function(){return false;};
      coin.style.webkitTapHighlightColor = "rgba(0,0,0,0)";
      coin.setAttribute('tabindex','-1');
      
      // Desktop click
      coin.onclick = function(e) {
        tapCoin(booster.multiTap || 1);
      };
      
      // Touch - multi-finger
      coin.ontouchstart = function(e){
        e.preventDefault();
        let touches = e.touches.length;
        let tapCount = Math.min(touches, booster.multiTap || 1);
        tapCoin(tapCount);
      };
    }

    function updateEnergyBar(){
      let label = document.getElementById('energyLabel');
      if(label){
        label.textContent = Math.floor(booster.energy)+' / '+booster.maxEnergy;
      }
    }
    function updateInfoRow() {
      let fingerEl = document.getElementById('fingerLabel');
      let profitEl = document.getElementById('profitLabel');
      if(fingerEl) fingerEl.textContent = booster.multiTap;
      if(profitEl) profitEl.textContent = booster.incomeBooster ? Math.floor(coinsEarned/3600) : 0;
    }

    function setupEnergyRecovery(){
      if(energyTimer) clearInterval(energyTimer);
      energyTimer = setInterval(()=>{
        if(booster.energy < booster.maxEnergy){
          booster.energy += 0.5;
          booster.energy = Math.min(booster.energy, booster.maxEnergy);
          updateUserData({energy:Math.round(booster.energy)});
          updateEnergyBar();
        }
      },1000);
    }

    let incomeBoosterTimer = null;
    function setupIncomeBooster(){
      if(incomeBoosterTimer) clearInterval(incomeBoosterTimer);
      if(booster.incomeBooster){
        incomeBoosterTimer = setInterval(()=>{
          coinsEarned++;
          updateUserData({balance:coinsEarned});
          updateInfoRow();
        },10000);
      }
    }

    function renderBooster(){
      let maxEnergyDisabled = (booster.maxEnergyUpCount||0) >= 10;
      let multiTapDisabled = (booster.multiTapCount||0) >= 3;
      let html = `<div class="booster-main">
        <div class="booster-section" style="background-image:url('https://github.com/akhterefti-del/Shark/blob/7799e462d86dda9a2cd8c175f882b9ed36892998/incomebtbt.png?raw=true')">
          <div class="title">Increase Energy</div>
          <div class="price">Price: 10,000 SHB</div>
          <button class="buy-btn" id="buyEnergy" ${coinsEarned<10000||maxEnergyDisabled?'disabled':''}>Buy</button>
          <div class="desc">Increase max energy by 500 each purchase. (${10-(booster.maxEnergyUpCount||0)} left)</div>
        </div>
        <div class="booster-section" style="background-image:url('https://github.com/akhterefti-del/Shark/blob/7799e462d86dda9a2cd8c175f882b9ed36892998/multitapbt.png?raw=true')">
          <div class="title">Tapping Booster</div>
          <div class="price">Price: 15,000 SHB</div>
          <button class="buy-btn" id="buyMultiTap" ${coinsEarned<15000||multiTapDisabled?'disabled':''}>Buy</button>
          <div class="desc">Buy once: 2 fingers. Buy again: 3, then 4 total. (${3-(booster.multiTapCount||0)} left)</div>
        </div>
        <div class="booster-section" style="background-image:url('https://github.com/akhterefti-del/Shark/blob/7799e462d86dda9a2cd8c175f882b9ed36892998/incomebt.png?raw=true')">
          <div class="title">Profit Per Hour</div>
          <div class="price">Price: 100,000 SHB</div>
          <button class="buy-btn" id="buyIncomeBooster" ${coinsEarned<100000||booster.incomeBooster?'disabled':''}>Buy</button>
          <div class="desc">Earn 1 SHB every 10s, even offline. Buy only once.</div>
        </div>
      </div>`;
      document.getElementById('main-content').innerHTML = html;
      document.getElementById('buyEnergy').onclick = function(){
        if(coinsEarned<10000 || (booster.maxEnergyUpCount||0) >= 10){notify('Cannot buy!');return;}
        coinsEarned -= 10000;
        booster.maxEnergy += 500;
        booster.energy = booster.maxEnergy;
        booster.maxEnergyUpCount = (booster.maxEnergyUpCount||0)+1;
        updateUserData({balance:coinsEarned,maxEnergy:booster.maxEnergy,energy:booster.maxEnergy,maxEnergyUpCount:booster.maxEnergyUpCount});
        notify('Max energy increased!');
        renderBooster();
      };
      document.getElementById('buyMultiTap').onclick = function(){
        if(coinsEarned<15000 || (booster.multiTapCount||0) >= 3){notify('Cannot buy!');return;}
        coinsEarned -= 15000;
        let nextTap = booster.multiTap==1?2:(booster.multiTap==2?3:4);
        booster.multiTap = nextTap;
        booster.multiTapCount = (booster.multiTapCount||0)+1;
        updateUserData({balance:coinsEarned,multiTap:nextTap,multiTapCount:booster.multiTapCount});
        notify('Multi-finger tapping upgraded!');
        renderBooster();
        if(document.querySelector('.home-main')) updateInfoRow();
      };
      document.getElementById('buyIncomeBooster').onclick = function(){
        if(coinsEarned<100000||booster.incomeBooster){notify('Cannot buy!');return;}
        coinsEarned -= 100000;
        booster.incomeBooster = true;
        updateUserData({balance:coinsEarned,incomeBooster:true});
        notify('Passive income enabled!');
        setupIncomeBooster();
        renderBooster();
        if(document.querySelector('.home-main')) updateInfoRow();
      };
    }

    function renderEarn(){
      let html = `<div class="earn-main">
        <div class="earn-graph-bar"><canvas id="adGraph" width="400" height="170"></canvas></div>
        <div class="earn-stats-bar">
          <div class="earn-stat-cell">
            <span class="earn-stat-label">Today</span>
            <span class="earn-stat-value">${adStats.today||0}</span>
          </div>
          <div class="earn-stat-cell">
            <span class="earn-stat-label">Daily</span>
            <span class="earn-stat-value">${adStats.daily||0}</span>
          </div>
          <div class="earn-stat-cell">
            <span class="earn-stat-label">Monthly</span>
            <span class="earn-stat-value">${adStats.monthly||0}</span>
          </div>
          <div class="earn-stat-cell">
            <span class="earn-stat-label">Lifetime</span>
            <span class="earn-stat-value">${adStats.lifetime||0}</span>
          </div>
        </div>
        <div class="ad-section">
          <div class="title" style="font-weight:bold;font-size:1.08rem;">SHOW ADS</div>
          <button class="show-ad-btn" id="showAdBtn">${adLoading?'Loading...':'Show Ad (+500 SHB)'}</button>
        </div>
        <div class="tasks-list" id="earnTasksList"></div>
      </div>`;
      document.getElementById('main-content').innerHTML = html;
      setupShowAd();
      loadTasksEarn();
      setTimeout(function(){
        let ctx = document.getElementById('adGraph').getContext('2d');
        let chart = new Chart(ctx, {
          type: 'bar',
          data: {
            labels: ['Today','Daily','Monthly','Lifetime'],
            datasets: [{
              label: 'Ad Views',
              data: [adStats.today||0, adStats.daily||0, adStats.monthly||0, adStats.lifetime||0],
              backgroundColor: [
                'rgba(0, 212, 255, 0.7)','rgba(255, 107, 53, 0.7)','rgba(255, 210, 62, 0.7)','rgba(232, 245, 250, 0.6)'
              ],
              borderColor: [
                '#00d4ff','#ff6b35','#ffd23e','#e8f5fa'
              ],
              borderWidth: 1.7
            }]
          },
          options: { plugins:{legend:{display:false}}, scales:{y:{beginAtZero:true}} }
        });
      },100);
    }
    function setupShowAd(){
      document.getElementById('showAdBtn').onclick = function(){
        if(adLoading)return;
        adLoading=true;
        this.textContent='Loading...';
        if(typeof show_9970324 === 'function'){
          show_9970324().then(()=>{
            adLoading=false;
            this.textContent='Show Ad (+500 SHB)';
            coinsEarned+=500;
            adStats.today++; adStats.daily++; adStats.monthly++; adStats.lifetime++;
            updateUserData({balance:coinsEarned,adStats});
            notify('+500 SHB for ad!');
            renderEarn();
          }).catch(err=>{
            adLoading=false; this.textContent='Show Ad (+500 SHB)';
            notify('Ad failed!');
          });
        }else{
          adLoading=false; this.textContent='Show Ad (+500 SHB)';
          notify('Ad not ready!');
        }
      };
    }
    function loadTasksEarn(){
      db.ref('tasks').once('value').then(snap=>{
        let tasks = snap.val()||{};
        let html = '';
        Object.keys(tasks).forEach(tid=>{
          let t = tasks[tid];
          let completed = userData.completedTasks&&userData.completedTasks[tid];
          html += `<div class="task-card">
            <img src="${t.photo}" class="task-photo" />
            <div class="task-info">
              <div class="task-title">${t.name}</div>
              <div class="task-amount">Earn: ${t.amount} SHB</div>
            </div>
            <button class="task-btn ${completed?'completed':''}" data-tid="${tid}">${completed?'Completed':'Start'}</button>
          </div>`;
        });
        document.getElementById('earnTasksList').innerHTML = html;
        document.querySelectorAll('.task-btn').forEach(btn=>{
          btn.onclick = function(){
            let tid = this.dataset.tid;
            if(userData.completedTasks&&userData.completedTasks[tid]){
              window.open(tasks[tid].link, '_blank');
              return;
            }
            coinsEarned += parseInt(tasks[tid].amount);
            if(!userData.completedTasks) userData.completedTasks={};
            userData.completedTasks[tid]=true;
            updateUserData({balance:coinsEarned,completedTasks:userData.completedTasks});
            notify(`+${tasks[tid].amount} SHB for completing task!`);
            renderEarn();
            window.open(tasks[tid].link, '_blank');
          };
        });
      });
    }

    // Load profile sections from Firebase
    function loadProfileSections(){
      return db.ref('profileSections').once('value').then(snap=>{
        let sections = snap.val()||{};
        profileSections = [];
        Object.keys(sections).forEach(sid=>{
          profileSections.push({
            id: sid,
            name: sections[sid].name,
            image: sections[sid].image,
            link: sections[sid].link
          });
        });
      });
    }

    function renderProfile(){
      let avatarURL = "https://github.com/akhterefti-del/Shark/blob/43434e64fd7f0a55152c5e982b6a95f2c0496c5b/Gemini_Generated_Image_ad2lr0ad2lr0ad2l.png?raw=true";
      
      loadProfileSections().then(()=>{
        db.ref('users')
          .orderByChild('referrals')
          .equalTo(userId)
          .once('value')
          .then(refSnap => {
            let myRefCount = userData.referrals || 0;
            let myEjectCount = userData.eject || 0;
            
            let sectionsHTML = '';
            profileSections.forEach(section => {
              sectionsHTML += `<div class="profile-section-card" onclick="window.open('${section.link}', '_blank')">
                <img src="${section.image}" class="profile-section-img" alt="${section.name}" />
                <div class="profile-section-title">${section.name}</div>
              </div>`;
            });
            
            let html = `<div class="profile-main">
              <div class="avatar-glow">
                <img src="${avatarURL}" class="avatar-img-pro" alt="Avatar"/>
              </div>
              <div>
                <span class="userid-pro">ID: ${userId}</span>
                <button class="copy-btn-pro" id="copyUidBtn"><img src="https://github.com/akhterefti-del/Shark/blob/414f316d45b382764893e66646e983d101310c2e/Gemini_Generated_Image_c5nuk1c5nuk1c5nu.png?raw=true" /></button>
              </div>
              <div class="profile-divider"></div>
              <div class="profile-wallet-box">
                <span class="wallet-label">TON wallet:</span>
                <form class="ton-form-pro" onsubmit="return false;">
                  <input class="ton-input-pro" id="tonInput" placeholder="Enter TON Wallet Address" value="${userData.ton||''}" />
                  <button class="ton-save-btn-pro" id="tonSaveBtn">Save</button>
                </form>
              </div>
              <div class="referral-section">
                <div style="font-weight:bold;margin-bottom:6px;">Referrals</div>
                <div class="ref-link-box">
                  <span class="ref-link" id="refLink">https://t.me/SharkBountybot?start=r${userId}</span>
                  <button class="ref-copy-btn-pro" id="refCopyBtn"><img src="https://github.com/akhterefti-del/Shark/blob/414f316d45b382764893e66646e983d101310c2e/Gemini_Generated_Image_c5nuk1c5nuk1c5nu.png?raw=true" /></button>
                </div>
                <div class="ref-counts">
                  <span>Total Referrals: <b id="refCount">${myRefCount}</b></span>
                  <span>Eject Referrals: <b id="ejectCount">${myEjectCount}</b></span>
                </div>
              </div>
              ${sectionsHTML}
              <div class="redeem-profile-box">
                <input class="redeem-input" id="redeemInput" maxlength="4" placeholder="Enter 4-digit code" />
                <button class="redeem-btn" id="redeemBtn">Redeem</button>
              </div>
            </div>`;
            document.getElementById('main-content').innerHTML = html;
            document.getElementById('copyUidBtn').onclick = function(){
              navigator.clipboard.writeText(userId).then(()=>notify('User ID copied!'));
            };
            document.getElementById('refCopyBtn').onclick = function(){
              navigator.clipboard.writeText(document.getElementById('refLink').textContent).then(()=>notify('Referral link copied!'));
            };
            document.getElementById('refLink').onclick = function(){
              navigator.clipboard.writeText(this.textContent).then(()=>notify('Referral link copied!'));
            };
            document.getElementById('tonSaveBtn').onclick = function(){
              let val = document.getElementById('tonInput').value.trim();
              if(val.length<10){notify('Invalid TON wallet!');return;}
              updateUserData({ton:val});
              notify('TON wallet saved!');
            };
            document.getElementById('redeemBtn').onclick = function(){
              let code = document.getElementById('redeemInput').value.trim();
              if(code.length!==4){notify('Enter valid 4-digit code!');return;}
              db.ref('redeemCodes/'+code).once('value').then(snap=>{
                if(snap.exists()){
                  let amount = Math.floor(Math.random()*(10000-500+1))+500;
                  coinsEarned += amount;
                  updateUserData({balance:coinsEarned});
                  db.ref('redeemCodes/'+code).remove();
                  notify('+'+amount+' SHB redeemed!');
                  renderProfile();
                }else{
                  notify('Invalid or already used code!');
                }
              });
            };
          });
      });
    }

    // LIVE RANKING SECTION
    let rankingListener = null;
    function renderRanking(){
      document.getElementById('main-content').innerHTML = `<div class="ranking-main">
        <div class="ranking-position" id="myRankingPos"></div>
        <div class="ranking-list" id="rankingList"></div>
      </div>`;
      if(rankingListener) rankingListener.off();
      const usersRef = db.ref('users');
      function updateRankingList(snap) {
        let arr = [];
        snap.forEach(child=>{
          arr.push({
            id: child.key,
            shb: child.val().balance || 0
          });
        });
        arr.sort((a,b)=>b.shb-a.shb);
        let myPos = arr.findIndex(u => u.id === userId) + 1;
        let top200 = arr.slice(0,200);
        let html = '';
        top200.forEach((row,i)=>{
          html += `<div class="ranking-row">
            <span class="ranking-pos">${i+1}</span>
            <span class="ranking-userid">ID: ${row.id}</span>
            <span class="ranking-shb">${row.shb} SHB</span>
          </div>`;
        });
        document.getElementById('rankingList').innerHTML = html;
        document.getElementById('myRankingPos').innerHTML = `Your Position: <b>${myPos > 0 ? myPos : 'Unranked'}</b>`;
      }
      usersRef.on('value', updateRankingList);
      rankingListener = usersRef;
    }

    document.querySelectorAll('.nav-btn').forEach(btn=>{
      btn.onclick = function(){
        if(btn.dataset.tab !== "home"){
          document.body.style.overflow = "";
          document.documentElement.style.overflow = "";
          document.getElementById('main-content').style.overflow = "";
          document.getElementById('main-content').style.height = "";
        }
        showTab(btn.dataset.tab);
      }
    });

    document.getElementById('intro-video').addEventListener('ended',()=>{
      document.getElementById('intro-video').style.display='none';
      document.getElementById('app').style.display='block';
      loadUserData();
    });
    document.getElementById('intro-video').addEventListener('error',()=>{
      document.getElementById('intro-video').style.display='none';
      document.getElementById('app').style.display='block';
      loadUserData();
    });
    window.onload = function(){
      if(document.getElementById('intro-video').ended||document.getElementById('intro-video').style.display==='none'){
        document.getElementById('intro-video').style.display='none';
        document.getElementById('app').style.display='block';
        loadUserData();
      }
    }

    // Initialize default profile sections if not exist
    db.ref('profileSections').once('value').then(snap=>{
      if(!snap.exists()){
        db.ref('profileSections').set({
          roadmap: {
            name: 'RoadMap',
            image: 'https://github.com/akhterefti-del/Shark/blob/7e14b838bb95a2bb6ab2cc81008d2b69cfbe2d0b/readmap.png?raw=true',
            link: '#######Link here'
          },
          presale: {
            name: 'Presale',
            image: 'https://github.com/akhterefti-del/Shark/blob/7e14b838bb95a2bb6ab2cc81008d2b69cfbe2d0b/presale.png?raw=true',
            link: '#######Link here'
          }
        });
      }
    });

    // Handle referral system - award 500 SHB for each referral
    function handleReferral(referrerId) {
      if (referrerId && referrerId !== userId) {
        db.ref('users/' + referrerId).once('value').then(snap => {
          if (snap.exists()) {
            let referrerData = snap.val();
            let newBalance = (referrerData.balance || 0) + 500;
            let newReferrals = (referrerData.referrals || 0) + 1;
            
            db.ref('users/' + referrerId).update({
              balance: newBalance,
              referrals: newReferrals
            });
          }
        });
      }
    }

    // Check for referral in URL
    function checkReferral() {
      const urlParams = new URLSearchParams(window.location.search);
      const refId = urlParams.get('start');
      if (refId && refId.startsWith('r')) {
        const referrerId = refId.substring(1);
        handleReferral(referrerId);
      }
    }

    // Check referral on load
    setTimeout(checkReferral, 2000);
  </script>
</body>
</html>
